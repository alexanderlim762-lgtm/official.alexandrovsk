<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Служба поддержки - Александровск</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- Верхнее меню -->
    <div class="vhs-menu">
    <ul>
        <li><a href="index.html">Главная</a></li>
        <li><a href="news.html">Новости</a></li>
        <li><a href="rules.html">Правила</a></li>
        <li><a href="updates.html">Обновления</a></li>
        <li><a href="plays.html">Проекты</a></li>
    </ul>
    <div>
        <img id="menu-avatar" class="menu-avatar" src="" alt="" onclick="goToProfile()">
        <span id="menu-login" class="menu-login" onclick="goToLogin()">Войти</span>
    </div>
</div>

<script>
let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;

const avatarEl = document.getElementById('menu-avatar');
const loginEl = document.getElementById('menu-login');

function updateMenu(){
    if(currentUser){
        avatarEl.src = currentUser.avatar || 'default-avatar.png';
        avatarEl.style.display = 'inline-block';
        loginEl.style.display = 'none';
    } else {
        avatarEl.style.display = 'none';
        loginEl.style.display = 'inline-block';
    }
}

function goToProfile(){
    if(currentUser) window.location.href = 'profile.html';
}

function goToLogin(){
    window.location.href = 'login.html';
}

updateMenu();
</script>
    

    <main>
        <div class="alert-container">
            <h1>Служба поддержки</h1>
            <p>Если у вас есть вопросы или проблемы, заполните форму ниже. Мы свяжемся с вами как можно быстрее.</p>

            <!-- Форма -->
            <form id="support-form" class="support-form" method="POST">
                <label for="username">Ваш никнейм Telegram:</label>
                <input type="text" id="username" name="username" placeholder="@username" required>

                <label for="message">Ваш вопрос:</label>
                <textarea id="message" name="message" rows="5" placeholder="Опишите вашу проблему" required></textarea>

                <button type="submit" class="vhs-button">ОТПРАВИТЬ</button>
            </form>
        </div>
    </main>

    <div class="footer-info">
        <span>VCR PLAY 00:42:15</span>
        <span>REC ●</span>
    </div>

    <!-- Скрипт для скрытой отправки -->
    <script>
        const form = document.getElementById('support-form');
        const email = "alexanderlim762@gmail.com"; // email скрыт в JS
        const nextPage = "https://alexandrovsk.c6t.ru/thank-you.html";

        form.addEventListener('submit', function(e){
            e.preventDefault(); // предотвращаем стандартную отправку

            const formData = new FormData(form);
            formData.append('_next', nextPage);
            formData.append('_captcha', 'false');

            // Отправка через fetch к formsubmit
            fetch('https://formsubmit.co/' + email, {
                method: 'POST',
                body: formData
            })
            .then(() => {
                alert('Ваша заявка отправлена!');
                form.reset();
            })
            .catch((err) => {
                alert('Ошибка отправки. Попробуйте ещё раз.');
                console.error(err);
            });
        });
    </script>

</body>
</html>
